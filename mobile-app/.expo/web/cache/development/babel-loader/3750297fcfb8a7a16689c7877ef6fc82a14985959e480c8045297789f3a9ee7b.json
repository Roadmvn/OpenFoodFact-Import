{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/home/roadmvn/devops/Devops_starter/mobile-app/src/contexts/CartContext.js\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport React, { createContext, useState, useContext, useEffect } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nvar CartContext = createContext(null);\nexport var useCart = function useCart() {\n  return useContext(CartContext);\n};\nexport default function CartProvider(_ref) {\n  var children = _ref.children;\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    cartItems = _useState2[0],\n    setCartItems = _useState2[1];\n  var _useState3 = useState(true),\n    _useState4 = _slicedToArray(_useState3, 2),\n    loading = _useState4[0],\n    setLoading = _useState4[1];\n  useEffect(function () {\n    loadCart();\n  }, []);\n  useEffect(function () {\n    if (!loading) {\n      saveCart();\n    }\n  }, [cartItems]);\n  var loadCart = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      try {\n        var storedCart = yield AsyncStorage.getItem('cart');\n        if (storedCart) {\n          setCartItems(JSON.parse(storedCart));\n        }\n      } catch (error) {\n        console.error('Erreur lors du chargement du panier:', error);\n      } finally {\n        setLoading(false);\n      }\n    });\n    return function loadCart() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var saveCart = function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      try {\n        yield AsyncStorage.setItem('cart', JSON.stringify(cartItems));\n      } catch (error) {\n        console.error('Erreur lors de la sauvegarde du panier:', error);\n      }\n    });\n    return function saveCart() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var addToCart = function addToCart(product) {\n    var quantity = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    setCartItems(function (currentItems) {\n      var existingItem = currentItems.find(function (item) {\n        return item.id === product.id;\n      });\n      if (existingItem) {\n        return currentItems.map(function (item) {\n          return item.id === product.id ? _objectSpread(_objectSpread({}, item), {}, {\n            quantity: item.quantity + quantity\n          }) : item;\n        });\n      }\n      return [].concat(_toConsumableArray(currentItems), [_objectSpread(_objectSpread({}, product), {}, {\n        quantity: quantity\n      })]);\n    });\n  };\n  var updateQuantity = function updateQuantity(productId, quantity) {\n    setCartItems(function (currentItems) {\n      return currentItems.map(function (item) {\n        return item.id === productId ? _objectSpread(_objectSpread({}, item), {}, {\n          quantity: quantity\n        }) : item;\n      });\n    });\n  };\n  var removeItem = function removeItem(productId) {\n    setCartItems(function (currentItems) {\n      return currentItems.filter(function (item) {\n        return item.id !== productId;\n      });\n    });\n  };\n  var clearCart = function clearCart() {\n    setCartItems([]);\n  };\n  var getItemCount = function getItemCount() {\n    return cartItems.reduce(function (total, item) {\n      return total + item.quantity;\n    }, 0);\n  };\n  var getTotal = function getTotal() {\n    return cartItems.reduce(function (total, item) {\n      return total + item.price * item.quantity;\n    }, 0);\n  };\n  var value = {\n    cartItems: cartItems,\n    loading: loading,\n    addToCart: addToCart,\n    updateQuantity: updateQuantity,\n    removeItem: removeItem,\n    clearCart: clearCart,\n    itemCount: getItemCount(),\n    total: getTotal()\n  };\n  if (loading) {\n    return null;\n  }\n  return React.createElement(CartContext.Provider, {\n    value: value,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 5\n    }\n  }, children);\n}","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","AsyncStorage","CartContext","useCart","CartProvider","_ref","children","_useState","_useState2","_slicedToArray","cartItems","setCartItems","_useState3","_useState4","loading","setLoading","loadCart","saveCart","_ref2","_asyncToGenerator","storedCart","getItem","JSON","parse","error","console","apply","arguments","_ref3","setItem","stringify","addToCart","product","quantity","length","undefined","currentItems","existingItem","find","item","id","map","_objectSpread","concat","_toConsumableArray","updateQuantity","productId","removeItem","filter","clearCart","getItemCount","reduce","total","getTotal","price","value","itemCount","createElement","Provider","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["/home/roadmvn/devops/Devops_starter/mobile-app/src/contexts/CartContext.js"],"sourcesContent":["import React, { createContext, useState, useContext, useEffect } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nconst CartContext = createContext(null);\n\nexport const useCart = () => useContext(CartContext);\n\nexport default function CartProvider({ children }) {\n  const [cartItems, setCartItems] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  // Charger le panier depuis le stockage local au démarrage\n  useEffect(() => {\n    loadCart();\n  }, []);\n\n  // Sauvegarder le panier à chaque modification\n  useEffect(() => {\n    if (!loading) {\n      saveCart();\n    }\n  }, [cartItems]);\n\n  const loadCart = async () => {\n    try {\n      const storedCart = await AsyncStorage.getItem('cart');\n      if (storedCart) {\n        setCartItems(JSON.parse(storedCart));\n      }\n    } catch (error) {\n      console.error('Erreur lors du chargement du panier:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const saveCart = async () => {\n    try {\n      await AsyncStorage.setItem('cart', JSON.stringify(cartItems));\n    } catch (error) {\n      console.error('Erreur lors de la sauvegarde du panier:', error);\n    }\n  };\n\n  const addToCart = (product, quantity = 1) => {\n    setCartItems(currentItems => {\n      const existingItem = currentItems.find(item => item.id === product.id);\n      \n      if (existingItem) {\n        return currentItems.map(item =>\n          item.id === product.id\n            ? { ...item, quantity: item.quantity + quantity }\n            : item\n        );\n      }\n\n      return [...currentItems, { ...product, quantity }];\n    });\n  };\n\n  const updateQuantity = (productId, quantity) => {\n    setCartItems(currentItems =>\n      currentItems.map(item =>\n        item.id === productId\n          ? { ...item, quantity }\n          : item\n      )\n    );\n  };\n\n  const removeItem = (productId) => {\n    setCartItems(currentItems =>\n      currentItems.filter(item => item.id !== productId)\n    );\n  };\n\n  const clearCart = () => {\n    setCartItems([]);\n  };\n\n  const getItemCount = () => {\n    return cartItems.reduce((total, item) => total + item.quantity, 0);\n  };\n\n  const getTotal = () => {\n    return cartItems.reduce(\n      (total, item) => total + (item.price * item.quantity),\n      0\n    );\n  };\n\n  const value = {\n    cartItems,\n    loading,\n    addToCart,\n    updateQuantity,\n    removeItem,\n    clearCart,\n    itemCount: getItemCount(),\n    total: getTotal()\n  };\n\n  if (loading) {\n    return null; // Ou un composant de chargement\n  }\n\n  return (\n    <CartContext.Provider value={value}>\n      {children}\n    </CartContext.Provider>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}